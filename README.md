# 【 [Track Conductor](https://shamojismm.github.io/TrackConductor/top/index.html) 】

*made by [@Shamoji_SMM](https://x.com/Shamoji_SMM)*

`Last Update: 2025/Apr/27`

このサイトは、スーパーマリオメーカー2内で製作される「**レール演奏**」の一部を自動化・補助するツールです。
また将来的に様々なリンクや資料を掲載するまとめサイトのようにできたらなと思っています。

なにか質問や報告等あれば製作者までお知らせください。

> This tool is being translated into English.  
> Please let me know if you have any suggestions for translating terms or sentences.

## 0. [旧ツール](https://shamojismm.github.io/TrackConductor/old/index.html)

新ツールとして2025年3月に公開する前の旧バージョンです。
現在新バージョンに移行できていない機能等がありますので必要な場合はお使いください。

## 1. [集音生成](https://shamojismm.github.io/TrackConductor/wiring/index.html)

主に**集音**(演奏に必要な楽器ブロック群を集めること)を自動化します。

MIDIファイルを用意してツールにインポートする方法とメロディをツールに直接入力する方法があります。
前者を推奨していますが、MIDIファイルを準備できない場合には後者をお使いください。

### MIDIファイルを準備する場合

作りたいメロディを決めたら、

- MIDIエディターを開き、空のトラックにメロディを適当な位置に入力、または貼り付けます。  

<img width="70%" src="https://github.com/user-attachments/assets/d7e71555-8d4b-49b5-b360-cb9e7c252d3b">

- もしくは、以下のようにメロディの前後に「MMstart」「MMend」というコメントイベントを挿入します
(大文字小文字は気にしなくてよい)。

<img width="70%" src="https://github.com/user-attachments/assets/aa871025-7349-44f7-be71-d1e5bfaab692">

ノートの始点のみ読み取るので、ノートの長さが短かかったりしても構いません。

これでMIDIファイルの準備はOKですが、最後にメロディのある**トラック番号**を覚えてください。
画像だと上から3番目でトラック番号は3ですね。

MIDIファイルは保存してツールの方を開きます。

<img width="70%" src="https://github.com/user-attachments/assets/089ee0d3-0a90-4ccc-8a85-5037d990be35">

「ファイルを選択」から先ほどのMIDIファイルをアップロードし、
トラック番号を選択して「読み込み」を押すと、画像のように表に色々入力されるはずです。

### ツールに直接入力する場合

このメロディを入力していきます。

<img width="60%" src="https://github.com/user-attachments/assets/acdf8912-91bb-4f5b-a616-4d9bd37d6221">

表の3行目の左端を「n分符」にして、

<img width="100%" src="https://github.com/user-attachments/assets/cc690cd7-a6b4-4200-8612-2ecdfb4caa71">

3行目に**音の長さ**(音が鳴ってから次の音が鳴るまで)を○分符で、  
5行目に基準音からの**音の高さ**を入力します。

○分符では`8+16`や`2-16+32`のような簡単な足し算・引き算ができます。  
また、`4.`は付点4分符(=`4+8`)、`2..`は複付点2分符(=`2+4+8`)のように入力することもできます。  
なお全符は`1`です。小数点には対応してないのでご注意ください。

音の高さについて、今回は左端を`0`として入力していますが他の値にしても構いません。  
たとえば、左端を`-5`とした場合、左から `-5`, `-2`, `0`, `5`... となります。

---

ここからは共通です。

**4分符長**を決めます。
単位は**フレーム**(f, 1/60秒)で、4拍子系なら以下の中から元の曲のBPMに近いものを選ぶとよいでしょう。

| BPM | 4分符長[f] | | BPM | 4分符長[f] |
| :-: | :-: | - | :-: | :-: | 
| 100.0 | 36.0 | | 141.2 | 25.5 |
| 109.1 | 33.0 | | 150.0 | 24.0 |
| 114.3 | 21.5 | | 160.0 | 22.5 |
| 120.0 | 30.0 | | 171.4 | 21.0 |
| 126.3 | 28.5 | | 200.0 | 18.0 |

任意のBPMにしたい場合は以下の式で求めることもできます。

```
BPM = 3600 / 4分符長[f]
4分符長[f] = 3600 / BPM
```

スクロール演奏に合わせたい場合はスクロールの1拍あたりのフレーム数にしてください。

次に**基準音**を設定します。  
マリオメーカー内の音の高さに対応していて、
MIDIファイルの方法なら最初の音、直接入力なら音高を`0`にした音の高さを選びます。

ここまでできたら**演奏**を押してみてください。  
正常に入力できていればメロディ通りに演奏されるはずです。



